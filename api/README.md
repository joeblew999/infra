# API Services

This directory contains go-zero API services that wrap infra packages, designed for MCP (Model Context Protocol) integration and external service interfaces.

## Architecture

```
api/[service]/
├── [service].api     # go-zero API definition
├── [service].go      # Main server file  
├── internal/         # Generated go-zero code
│   ├── config/
│   ├── handler/
│   ├── logic/        # Business logic integration
│   ├── svc/
│   └── types/
└── etc/              # Configuration files
```

## Code Generation

**IMPORTANT**: All code in `internal/` is generated by goctl. Do not edit generated files directly.

### Using infra's go-zero wrapper (Recommended)
```bash
# Create new MCP-compatible service
infra gozero api create myservice --mcp --output ./api/myservice

# Create standard service
infra gozero api create myservice --output ./api/myservice
```

### Manual goctl commands
```bash
cd api/[service]/
.dep/goctl api go -api [service].api -dir .
.dep/goctl api swagger -api [service].api -dir .
```

### Initialize Go Module
```bash
cd api/[service]/
go mod init github.com/joeblew999/infra/api/[service]
go mod tidy
```

## Available APIs

- **deck** - Deck presentation generation API for MCP integration

## MCP Integration Flow

1. **MCP Client** sends description (e.g., "pack of playing cards")
2. **API Handler** generates appropriate format (.dsh, XML, SVG, etc.)
3. **Business Logic** calls existing `pkg/[package]` functionality
4. **Response** returns generated content for MCP client

## Development Workflow

1. Edit `[package].api` file
2. Run `goctl api go -api [package].api -dir .`
3. Implement business logic in `internal/logic/` files
4. Test API endpoints
5. Generate Swagger docs

## File Types by Generation

- **Generated (DO NOT EDIT)**: `internal/types/`, `internal/config/`, handler registration
- **Safe to Edit**: `internal/logic/`, main server file, configuration values

## Directory Structure Benefits

- **Clear Separation**: `pkg/` for reusable libraries, `api/` for service interfaces
- **Consistent with web/**: Service interfaces at root level alongside web interfaces  
- **Clean Imports**: `pkg/deck` for library, `api/deck` for service
- **Industry Standard**: Follows Kubernetes/Docker project layout patterns

## Notes

- Each API service wraps functionality from `pkg/[package]` libraries
- APIs are designed for MCP client integration and external service interfaces
- Use infra's go-zero wrapper for consistent patterns and automated setup
- Follow go-zero conventions for consistent development experience