

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infrastructure Management System</title>
    {{.Header}}
    {{.DataStar}}
</head>
<body class="bg-white dark:bg-gray-900 text-base sm:text-lg max-w-4xl mx-auto px-4 sm:px-6 py-4 sm:py-8">
    
    {{.Navigation}}
    
    <!-- Original DataStar Demo -->
    <div data-signals-delay="400" class="bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400 rounded-lg px-4 sm:px-6 py-6 sm:py-8 ring shadow-xl ring-gray-900/5 space-y-2 mb-6 sm:mb-8">
        <div class="flex justify-between items-center">
            <h1 class="text-gray-900 dark:text-white text-2xl sm:text-3xl font-semibold">
                DataStar SDK Demo
            </h1>
            <img src="https://data-star.dev/static/images/rocket-64x64.png" alt="Rocket" width="64" height="64"/>
        </div>
        <p class="mt-2">
            SSE events will be streamed from the backend to the frontend.
        </p>
        <div class="space-x-2">
            <label for="delay">
                Delay in milliseconds
            </label>
            <input data-bind-delay id="delay" type="number" step="100" min="0" class="w-36 rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-sky-500 focus:outline focus:outline-sky-500 dark:disabled:border-gray-700 dark:disabled:bg-gray-800/20" />
        </div>
        <button data-on-click="@get('/hello-world')" class="rounded-md bg-sky-500 px-5 py-2.5 leading-5 font-semibold text-white hover:bg-sky-700 hover:text-gray-100 cursor-pointer">
            Start TypeWriter
        </button>
        <div class="my-8 text-4xl font-bold text-transparent" style="background: linear-gradient(to right in oklch, red, orange, yellow, green, blue, blue, violet); background-clip: text">
            <div id="message">Hello, world!</div>
        </div>
    </div>

    <!-- NATS + DataStar Demo -->
    <div data-signals-message="" class="bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400 rounded-lg px-4 sm:px-6 py-6 sm:py-8 ring shadow-xl ring-gray-900/5 space-y-4">
        <div class="flex justify-between items-center">
            <h2 class="text-gray-900 dark:text-white text-2xl font-semibold">
                NATS → DataStar → Browser Demo
            </h2>
            <div class="text-green-500 font-mono text-sm">
                🟢 Embedded NATS Server
            </div>
        </div>
        
        <p class="text-sm">
            This demonstrates the data flow: NATS JetStream → DataStar SSE → Real-time Browser Updates
        </p>

        <!-- Message Input -->
        <div class="space-y-2">
            <label for="messageInput" class="block text-sm font-medium">
                Publish Message to NATS
            </label>
            <div class="flex space-x-2">
                <input 
                    data-bind-message 
                    id="messageInput" 
                    type="text" 
                    placeholder="Enter a message..." 
                    class="flex-1 rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-sky-500 focus:outline focus:outline-sky-500 dark:disabled:border-gray-700 dark:disabled:bg-gray-800/20" 
                />
                <button 
                    data-on-click="@post('/publish', {content: $message})" 
                    class="rounded-md bg-green-500 px-4 py-2 leading-5 font-semibold text-white hover:bg-green-700 hover:text-gray-100 cursor-pointer">
                    Publish
                </button>
            </div>
        </div>

        <!-- Real-time Stream Connection -->
        <div class="space-y-2">
            <button 
                data-on-click="@get('/nats-stream')" 
                class="rounded-md bg-purple-500 px-4 py-2 leading-5 font-semibold text-white hover:bg-purple-700 hover:text-gray-100 cursor-pointer">
                🔌 Connect to NATS Stream
            </button>
            <p class="text-xs text-gray-600 dark:text-gray-400">
                Click to start receiving real-time messages from NATS JetStream
            </p>
        </div>

        <!-- Messages Display -->
        <div class="border-t pt-4">
            <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-2">
                📨 Live Messages
            </h3>
            <div id="messages" class="space-y-2 min-h-[100px] max-h-[300px] overflow-y-auto p-3 bg-gray-50 dark:bg-gray-900 rounded border">
                <div class="text-gray-500 italic">Waiting for messages...</div>
            </div>
        </div>

        <!-- Architecture Info -->
        <div class="border-t pt-4 text-xs text-gray-600 dark:text-gray-400 space-y-1">
            <div><strong>Architecture:</strong></div>
            <div>1. 📝 Type message → POST /publish</div>
            <div>2. 📡 Go server → NATS JetStream (messages.demo subject)</div>
            <div>3. 🔄 NATS subscription → DataStar SSE</div>
            <div>4. ⚡ SSE → Browser DOM updates</div>
            <div>5. 🌐 Real-time UI updates without page refresh</div>
        </div>

        <!-- NATS Info -->
        <div class="border-t pt-2 text-xs text-gray-600 dark:text-gray-400">
            <div>📊 Embedded NATS Server with JetStream persistence</div>
        </div>
    </div>

    {{.Footer}}

</body>
</html>